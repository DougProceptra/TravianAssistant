const f="__tla_bar__";function b(){let e=document.getElementById(f);return e||(e=document.createElement("div"),e.id=f,e.style.position="fixed",e.style.top="8px",e.style.right="8px",e.style.padding="6px 10px",e.style.background="rgba(0,0,0,.7)",e.style.color="white",e.style.font="12px/1.2 system-ui, sans-serif",e.style.borderRadius="8px",e.style.zIndex="2147483647",e.textContent="TLA overlay",document.body.appendChild(e)),e}const h={dorf1:{resources:{wood:{value:"#l1 .value",perHour:"#l1 .prod"},clay:{value:"#l2 .value",perHour:"#l2 .prod"},iron:{value:"#l3 .value",perHour:"#l3 .prod"},crop:{value:"#l4 .value",perHour:"#l4 .prod",net:"#stockBar .res .crop .balance"}},capacity:{warehouse:"#stockBar .warehouse",granary:"#stockBar .granary"}}},x={pages:h},_=300;let d;function N(e){return e.includes("dorf1")?"dorf1":e.includes("dorf2")?"dorf2":e.includes("build.php")?"build":e.includes("hero.php")?"hero":e.includes("gid=16")?"rally":e.includes("gid=17")?"market":"other"}function t(e){if(!e)return;const o=e.replace(/\u00A0/g," ").replace(/\./g,"").replace(/,/,".").match(/-?[\d.]+/),n=o?Number(o[0]):NaN;return Number.isFinite(n)?n:void 0}function B(e){const r=x.pages.dorf1,o=p=>{var y;return p?(y=e.querySelector(p))==null?void 0:y.textContent:void 0},n=t(o(r.resources.wood.value)),u=t(o(r.resources.clay.value)),s=t(o(r.resources.iron.value)),a=t(o(r.resources.crop.value)),l=t(o(r.resources.wood.perHour)),i=t(o(r.resources.clay.perHour)),c=t(o(r.resources.iron.perHour)),v=t(o(r.resources.crop.perHour)),m=t(o(r.resources.crop.net)),w=t(o(r.capacity.warehouse)),H=t(o(r.capacity.granary));if(!(n==null||u==null||s==null||a==null))return{resources:{wood:{current:n,perHour:l},clay:{current:u,perHour:i},iron:{current:s,perHour:c},crop:{current:a,perHour:v,net:m}},capacity:{warehouse:w,granary:H}}}function g(){var o,n,u,s,a,l;const e=N(location.pathname+location.search);let r;if(e==="dorf1"&&(r=B(document)),r){window.postMessage({__tla:!0,type:"SNAPSHOT/UPSERT",page:e,ts:Date.now(),payload:r},"*");const i=b(),c=r==null?void 0:r.resources;c&&(i.textContent=`W:${(o=c.wood)==null?void 0:o.current} C:${(n=c.clay)==null?void 0:n.current} I:${(u=c.iron)==null?void 0:u.current} G:${(s=c.crop)==null?void 0:s.current} | Cap W:${(a=r.capacity)==null?void 0:a.warehouse} G:${(l=r.capacity)==null?void 0:l.granary}`)}}function C(){d&&clearTimeout(d),d=setTimeout(g,_)}const P=new MutationObserver(C);P.observe(document.documentElement,{subtree:!0,childList:!0,characterData:!0});g();
